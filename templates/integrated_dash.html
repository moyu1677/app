<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>æŠ‘éƒç—‡æ£€æµ‹</title>
  <link rel="stylesheet" type="text/css" href="/static/CSS/style.css" />
  <script type="text/javascript" src="/static/js/d3/d3.js"></script>
  <script src="//d3js.org/d3-scale-chromatic.v0.3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.7.1/d3-tip.min.js"></script>
  <style>
    body {
      margin: 0; 
      font-family: Arial, sans-serif;
      height: 100vh;
      display: flex;
      overflow: hidden;
    }
    /* ä¾§è¾¹æ  */
    #sidebar {
      width: 220px;
      background: #2f3e46;
      color: white;
      display: flex;
      flex-direction: column;
      padding-top: 20px;
      box-sizing: border-box;
    }
    #sidebar h2 {
      text-align: center;
      margin-bottom: 30px;
      font-weight: normal;
    }
    .sidebar-item {
      padding: 15px 20px;
      cursor: pointer;
      border-left: 5px solid transparent;
      transition: background 0.3s, border-left-color 0.3s;
    }
    .sidebar-item:hover {
      background: #354f52;
    }
    .sidebar-item.active {
      background: #52796f;
      border-left-color: #84a98c;
      font-weight: bold;
    }
    /* å³ä¾§å¤§å†…å®¹åŒºåŸŸ */
    #content {
      flex-grow: 1;
      background: #f0f0f0;
      padding: 20px 40px;
      overflow-y: auto;
    }
    /* éšè—çš„å†…å®¹åŒº */
    .content-section {
      display: none;
    }
    .content-section.active {
      display: block;
    }
    /* æ ‡é¢˜æ ·å¼ */
    h2.section-title {
      margin-top: 0;
      margin-bottom: 15px;
      color: #2f3e46;
      font-style: italic;
    }
    /* ç»Ÿä¸€å›¾ä¾‹å°åœ†ç‚¹ */
    .key-dot {
      display: inline-block;
      width: 12px; height: 12px;
      border-radius: 50%;
      margin-right: 6px;
      vertical-align: middle;
    }
    .you { background: #1f7a8c; }
    .others { background: #f2cc8f; }
    /* ç®€å•æ»šåŠ¨æ¡ç¾åŒ– */
    #content::-webkit-scrollbar {
      width: 8px;
    }
    #content::-webkit-scrollbar-thumb {
      background-color: #84a98c;
      border-radius: 4px;
    }

    /* ç»¼åˆç»“æœåŒºåŸŸçš„æ ·å¼ç¤ºä¾‹ */
    #integrated-result {
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    #integrated-result h2 {
      margin-top: 0;
      margin-bottom: 15px;
      color: #2f3e46;
    }
  </style>
</head>
<body>

  <div id="sidebar">
    <h2>ä»ªè¡¨ç›˜å¯¼èˆª</h2>
    <div class="sidebar-item active" data-target="audio-section">éŸ³é¢‘æƒ…ç»ª</div>
    <div class="sidebar-item" data-target="video-section">è§†é¢‘æƒ…æ„Ÿ</div>
    <div class="sidebar-item" data-target="text-section">æ–‡æœ¬å¿ƒç†</div>
    <div class="sidebar-item" data-target="integrated-section">ç»¼åˆç»“æœ</div>
    <div class="sidebar-item" data-target="ganyu-section">å¹²é¢„</div>
  </div>

  <div id="content">

    <!-- éŸ³é¢‘æƒ…ç»ªåŒºåŸŸ -->
    <section id="audio-section" class="content-section active">
      <h2 class="section-title">Perceived Audio Emotions (éŸ³é¢‘æƒ…ç»ªè¯†åˆ«)</h2>
      <!-- ä¿æŒä¹‹å‰æ‰€æœ‰å†…å®¹ä¸å˜ -->
      <div class="legend1">
        <p><span class="key-dot you"></span>æ‚¨</p>
        <p><span class="key-dot others"></span>å…¶ä»–å€™é€‰äºº</p>
      </div>
      <div id="audio_emotions_dist" style="margin-top: 10px;"></div>
      <p>æ‚¨æœ€é¢‘ç¹çš„æƒ…ç»ªæ˜¯ï¼š<b>{{ aud_emo }}</b></p>
      <div class="parent">
        <ul>
          <li>æ„¤æ€’    : {{ aud_prob[0] }}%</li>
          <li>åŒæ¶    : {{ aud_prob[1] }}%</li>
          <li>ææƒ§    : {{ aud_prob[2] }}%</li>
          <li>å¼€å¿ƒ    : {{ aud_prob[3] }}%</li>
          <li>ä¸­æ€§    : {{ aud_prob[4] }}%</li>
          <li>æ‚²ä¼¤    : {{ aud_prob[5] }}%</li>
          <li>æƒŠè®¶    : {{ aud_prob[6] }}%</li>
        </ul>
      </div>
      <hr>
      <h3>å…¶ä»–å€™é€‰äººæƒ…ç»ª</h3>
      <div id="audio_emotions_dist_other" style="margin-top: 10px;"></div>
      <p>å…¶ä»–å€™é€‰äººæœ€é¢‘ç¹çš„æƒ…ç»ªæ˜¯ï¼š<b>{{ aud_emo_other }}</b></p>
      <div class="parent">
        <ul>
          <li>æ„¤æ€’    : {{ aud_prob_other[0] }}%</li>
          <li>åŒæ¶    : {{ aud_prob_other[1] }}%</li>
          <li>ææƒ§    : {{ aud_prob_other[2] }}%</li>
          <li>å¼€å¿ƒ    : {{ aud_prob_other[3] }}%</li>
          <li>ä¸­æ€§    : {{ aud_prob_other[4] }}%</li>
          <li>æ‚²ä¼¤    : {{ aud_prob_other[5] }}%</li>
          <li>æƒŠè®¶    : {{ aud_prob_other[6] }}%</li>
        </ul>
      </div>
    </section>

    <!-- è§†é¢‘æƒ…æ„ŸåŒºåŸŸ -->
    <section id="video-section" class="content-section">
      <h2 class="section-title">Perceived Video Emotions (è§†é¢‘æƒ…æ„Ÿè¯†åˆ«)</h2>
      <div class="legend1">
        <p><span class="key-dot you"></span>ä½ </p>
        <p><span class="key-dot others"></span>å…¶ä»–æµ‹è¯•è€…</p>
      </div>
      <div id="hist_density_perso" style="margin-top: 10px;"></div>
      <h3>æ‚¨æœ€é¢‘ç¹å‡ºç°çš„æƒ…æ„Ÿæ˜¯ï¼š<b>{{ vid_emo }}</b></h3>
      <div class="parent">
        <ul>
          <li>æ„¤æ€’ï¼š{{ vid_prob[0] }}%</li>
          <li>åŒæ¶ï¼š{{ vid_prob[1] }}%</li>
          <li>ææƒ§ï¼š{{ vid_prob[2] }}%</li>
          <li>å¿«ä¹ï¼š{{ vid_prob[3] }}%</li>
          <li>æ‚²ä¼¤ï¼š{{ vid_prob[4] }}%</li>
          <li>æƒŠè®¶ï¼š{{ vid_prob[5] }}%</li>
          <li>ä¸­æ€§ï¼š{{ vid_prob[6] }}%</li>
        </ul>
      </div>
      <hr>
      <h3>å…¶ä»–æµ‹è¯•è€…æƒ…æ„Ÿ</h3>
      <div id="hist_density" style="margin-top: 10px;"></div>
      <p>å…¶ä»–æµ‹è¯•è€…æœ€é¢‘ç¹å‡ºç°çš„æƒ…æ„Ÿæ˜¯ï¼š<b>{{ vid_emo_other }}</b></p>
      <div class="parent">
        <ul>
          <li>Angry    : {{ vid_prob_other[0] }}%</li>
          <li>Disgust  : {{ vid_prob_other[1] }}%</li>
          <li>Fear     : {{ vid_prob_other[2] }}%</li>
          <li>Happy    : {{ vid_prob_other[3] }}%</li>
          <li>Neutral  : {{ vid_prob_other[4] }}%</li>
          <li>Sad      : {{ vid_prob_other[5] }}%</li>
          <li>Surprise : {{ vid_prob_other[6] }}%</li>
        </ul>
      </div>
      <hr>
      <h3>æƒ…æ„Ÿéšæ—¶é—´å˜åŒ–</h3>
      <iframe src="static/CSS/chart.html" width="100%" height="300" frameborder="0"></iframe>
    </section>

    <!-- æ–‡æœ¬å¿ƒç†åŒºåŸŸ -->
    <section id="text-section" class="content-section">
      <h2 class="section-title">Perceived Psychological Traits (æ–‡æœ¬å¿ƒç†ç‰¹è´¨)</h2>
      <div class="legend1">
        <p><span class="key-dot you"></span>æ‚¨</p>
        <p><span class="key-dot others"></span>å…¶ä»–å€™é€‰äºº</p>
      </div>
      <div id="histo" style="margin-top: 10px;"></div>
      <p>æ‚¨æœ€æ˜¾è‘—çš„ç‰¹è´¨æ˜¯ï¼š<b>{{ trait }}</b></p>
      <div class="parent">
        <ul>
          <li>å¤–å‘æ€§ï¼š{{ traits[0] }}%</li>
          <li>ç¥ç»è´¨ï¼š{{ traits[1] }}%</li>
          <li>å®œäººæ€§ï¼š{{ traits[2] }}%</li>
          <li>è´£ä»»å¿ƒï¼š{{ traits[3] }}%</li>
          <li>å¼€æ”¾æ€§ï¼š{{ traits[4] }}%</li>
        </ul>
      </div>
      <p>æ‚¨ä½¿ç”¨çš„é«˜é¢‘è¯æ±‡ï¼š</p>
      <ul>
        {% for el in common_words %}
          <li>{{ el }}</li>
        {% endfor %}
      </ul>
      <hr>
      <h3>å…¶ä»–å€™é€‰äººå¿ƒç†ç‰¹è´¨</h3>
      <div id="hist_density_other" style="margin-top: 10px;"></div>
      <p>å…¶ä»–å€™é€‰äººæœ€æ˜¾è‘—çš„ç‰¹è´¨æ˜¯ï¼š<b>{{ trait_others }}</b></p>
      <div class="parent">
        <ul>
          <li>å¤–å‘æ€§ï¼š{{ probas_others[0] }}%</li>
          <li>ç¥ç»è´¨ï¼š{{ probas_others[1] }}%</li>
          <li>å®œäººæ€§ï¼š{{ probas_others[2] }}%</li>
          <li>è´£ä»»å¿ƒï¼š{{ probas_others[3] }}%</li>
          <li>å¼€æ”¾æ€§ï¼š{{ probas_others[4] }}%</li>
        </ul>
      </div>
      <p>å…¶ä»–å€™é€‰äººä½¿ç”¨çš„é«˜é¢‘è¯æ±‡ï¼š</p>
      <ul>
        {% for el in common_words_others %}
          <li>{{ el }}</li>
        {% endfor %}
      </ul>
    </section>

    <!-- ç»¼åˆç»“æœåŒºåŸŸ -->
	<section id="integrated-section" class="content-section">
	  <div id="integrated-result">
	    <h2>ç»¼åˆåˆ†æç»“æœ</h2>
	    <p><b>æ•´ä½“æƒ…ç»ªå€¾å‘ï¼š</b> {{ integrated_emotion }} </p>
	    <p><b>å¿ƒç†ç‰¹è´¨ç»¼åˆè¯„åˆ†ï¼š</b> {{ integrated_trait_score }} </p>
	    <p><b>æŠ‘éƒç­‰çº§åˆ¤æ–­ï¼š</b> 
	      <span id="depression-level">{{ depression_level }}</span>
	    </p>
	    <p id="depression-desc">{{ depression_description }}</p>
	
	    <p><b>æ€»ç»“è¯„ä»·ï¼š</b></p>
	    <p>{{ integrated_summary }}</p>
	
	    <div id="integrated_chart" style="margin-top: 20px; height: 400px;">
	      <!-- ä½ å¯ä»¥ç”¨D3æˆ–å…¶ä»–åº“ç»˜åˆ¶ç»¼åˆå¯è§†åŒ– -->
	    </div>
	  </div>
	</section>

    <!-- å¹²é¢„ç³»ç»ŸåŒºåŸŸ -->
	<section id="ganyu-section" class="content-section">
	  <div id="integrated-result">
	    <h2>å¹²é¢„ç³»ç»Ÿä¸­å¿ƒ</h2>
	    <p>è¯·é€‰æ‹©æ‚¨å¸Œæœ›è¿›è¡Œçš„å¹²é¢„æ–¹å¼ï¼š</p>
	
	    <!-- å­æ¨¡å—å¯¼èˆª -->
	    <div class="intervention-nav">
	      <button class="intervention-btn" data-subtarget="game-section">ğŸ® å°æ¸¸æˆ</button>
	      <button class="intervention-btn" data-subtarget="regulation-section">ğŸ§˜ æƒ…ç»ªè°ƒæ§</button>
	      <button class="intervention-btn" data-subtarget="log-section">ğŸ““ æƒ…ç»ªæ—¥å¿—</button>
	      <button class="intervention-btn" data-subtarget="ai-section">ğŸ¤– AIé™ªä¼´</button>
	      <button class="intervention-btn" data-subtarget="pet-section">ğŸ¾ è™šæ‹Ÿå® ç‰©</button>
	    </div>
	
	    	<!-- å­æ¨¡å—å†…å®¹ -->
				<div class="intervention-content">
				  <div id="game-section" class="sub-content active">
				    <h3>å°æ¸¸æˆ</h3>
				    <p>é€šè¿‡ç®€çŸ­çš„ç›Šæ™ºå°æ¸¸æˆï¼Œåˆ†æ•£æ³¨æ„åŠ›ï¼Œå¸®åŠ©ç¼“è§£è´Ÿé¢æƒ…ç»ªã€‚</p>
				    
				    <!-- æ¸¸æˆåˆ‡æ¢æŒ‰é’® -->
				    <div class="game-nav">
				      <button class="game-btn" data-game="flappy">ğŸ¦ Flappy Bird</button>
				      <button class="game-btn" data-game="tetris">ğŸ§© ä¿„ç½—æ–¯æ–¹å—</button>
				      <button class="game-btn" data-game="snake">ğŸ è´ªåƒè›‡</button>
				    </div>
				    
				    <!-- ä¸åŒæ¸¸æˆçš„ iframe å®¹å™¨ -->
				    <div class="game-content">
				      <iframe id="flappy" class="game-frame active" src="games/sample_game.html" width="50%" height="700" frameborder="0"></iframe>
				      <iframe id="tetris" class="game-frame" src="games/tetris.html" width="50%" height="700" frameborder="0"></iframe>
				      <iframe id="snake" class="game-frame" src="games/snake.html" width="100%" height="700" frameborder="0"></iframe>
				    </div>
				  </div>
				</div>
				
				<style>
				  .game-frame { display: none; }
				  .game-frame.active { display: block; }
				</style>
				
				<script>
				  document.querySelectorAll(".game-btn").forEach(btn => {
				    btn.addEventListener("click", () => {
				      const target = btn.dataset.game;
				      // éšè—æ‰€æœ‰æ¸¸æˆ
				      document.querySelectorAll(".game-frame").forEach(frame => {
				        frame.classList.remove("active");
				      });
				      // æ˜¾ç¤ºç‚¹å‡»çš„é‚£ä¸ª
				      document.getElementById(target).classList.add("active");
				    });
				  });
				</script>
	
	      <div id="regulation-section" class="sub-content">
	        <h3>æƒ…ç»ªè°ƒæ§</h3>
	        <p>æä¾›å‘¼å¸è®­ç»ƒã€å†¥æƒ³éŸ³ä¹å’Œæ¸è¿›æ€§è‚Œè‚‰æ”¾æ¾æŒ‡å¯¼ã€‚</p>
	        <iframe src="regulation/emotion_regulation.html" width="100%" height="700" frameborder="0"></iframe>
	      </div>
	
	      <div id="log-section" class="sub-content">
				  <h3>ğŸ“– æƒ…ç»ªæ—¥è®°æœ¬</h3>
					<p>ä¸ AI èŠå¤©æœºå™¨äººäº¤æµï¼Œè·å¾—å®‰æ…°ä¸å»ºè®®ã€‚</p>
					<iframe src="diary/emotion_diary.html" width="100%" height="700" frameborder="0"></iframe>
				</div>
				

	      <div id="ai-section" class="sub-content">
	        <h3>AIé™ªä¼´</h3>
	        <p>ä¸ AI èŠå¤©æœºå™¨äººäº¤æµï¼Œè·å¾—å®‰æ…°ä¸å»ºè®®ã€‚</p>
	        <iframe src="chat/ai_companion.html" width="100%" height="700" frameborder="0"></iframe>
	      </div>
	
	      <div id="pet-section" class="sub-content">
				  <h3>è™šæ‹Ÿå® ç‰©</h3>
				  <p>ä¸ä¸€åªå¯çˆ±çš„è™šæ‹Ÿå® ç‰©äº’åŠ¨ï¼ŒåŸ¹å…»ç§¯ææƒ…ç»ªã€‚</p>
				  <iframe id="pet-frame" width="70%" height="700" frameborder="0"></iframe>
				</div>
				
				<script>
				  const petFrame = document.getElementById("pet-frame");
				  // è¯»å– localStorage åˆ¤æ–­
				  const savedPet = localStorage.getItem("petData");
				  if (savedPet) {
				    petFrame.src = "pet/pet_game.html";   // å·²æœ‰å® ç‰© â†’ è¿›å…¥æ¸¸æˆé¡µ
				  } else {
				    petFrame.src = "pet/pet_home.html";   // ç¬¬ä¸€æ¬¡ â†’ è¿›å…¥åˆ›å»ºé¡µ
				  }
				</script>
				
	    </div>
	  </div>
	</section>

	<style>
	  .intervention-nav {
	    margin: 15px 0;
	    display: flex;
	    gap: 10px;
	    flex-wrap: wrap;
	  }
	  .intervention-btn {
	    padding: 8px 14px;
	    border: none;
	    border-radius: 6px;
	    background: #52796f;
	    color: white;
	    cursor: pointer;
	    transition: background 0.3s;
	  }
	  .intervention-btn:hover {
	    background: #354f52;
	  }
	  .sub-content { display: none; margin-top: 15px; }
	  .sub-content.active { display: block; }
	</style>
	
	<script>
	  const interventionBtns = document.querySelectorAll('.intervention-btn');
	  const subContents = document.querySelectorAll('.sub-content');
	
	  interventionBtns.forEach(btn => {
	    btn.addEventListener('click', () => {
	      subContents.forEach(s => s.classList.remove('active'));
	      document.getElementById(btn.dataset.subtarget).classList.add('active');
	    });
	  });
	</script>

  </div>

  <script>
    const sidebarItems = document.querySelectorAll('.sidebar-item');
    const contentSections = document.querySelectorAll('.content-section');

    sidebarItems.forEach(item => {
      item.addEventListener('click', () => {
        sidebarItems.forEach(i => i.classList.remove('active'));
        contentSections.forEach(s => s.classList.remove('active'));
        item.classList.add('active');
        const target = item.getAttribute('data-target');
        document.getElementById(target).classList.add('active');
      });
    });
  </script>

  <!-- å¼•å…¥ç»˜å›¾è„šæœ¬ -->
  <script type="text/javascript" src="/static/js/hist_aud_perso.js"></script>
  <script type="text/javascript" src="/static/js/hist_aud_glob.js"></script>
  <script type="text/javascript" src="/static/js/hist_vid_perso.js"></script>
  <script type="text/javascript" src="/static/js/hist_vid_glob.js"></script>
  <script type="text/javascript" src="/static/js/hist_txt_perso.js"></script>
  <script type="text/javascript" src="/static/js/hist_txt_glob.js"></script>
  <!-- ä½ è¿˜å¯ä»¥åœ¨è¿™é‡ŒåŠ åŠ è½½ç»¼åˆå›¾è¡¨çš„è„šæœ¬ -->

</body>
</html>
